---
title: "SCCOOS_Automated_Shore_Stations"
author: "Megan Hepner"
date: "7/20/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(cowplot) #get_legend 
library(dygraphs) #dygraphs 
library(ggplot2) #ggplot
library(tidyverse)
library(vegan) #spec, diversity
library(htmlwidgets)
library(xts)
library(lubridate) 
library(zoo) #as.yearmon
library(shiny)

```

## SCCOOS Automated Shore Station Data 

```{r cars}

ass_temp = read_csv("2018_07_20_automated_shorestations.csv") 

#Parsed with column specification:
#cols(station = col_character(),time = col_datetime(format = ""),temperature = col_double())

ass_temp_date = ass_temp %>%  
  mutate(date = as.Date(time, format ="%m/%d/%Y/%HH/%mm/%ss"), "%Y-%m") %>%
  mutate(year = format(as.Date(time, format="%m/%d/%Y/%HH/%mm/%ss"), "%Y")) %>% 
  mutate(month = format(as.Date(time, format="%m/%d/%Y/%HH/%mm/%ss"), "%m")) %>% 
  mutate(year = as.integer(year)) %>%
  mutate(month = as.integer(month)) %>%
  mutate(year_month = make_datetime(year, month)) 
  
ass_temp_year_month = ass_temp_date %>%
  group_by(year_month, station) %>% 
    summarize(
      temperature_mean = mean(temperature),
      temperature_n = length(temperature),
      temperature_sd = sd(temperature),
      temperature_se = temperature_sd /sqrt(temperature_n)) 
  
ass_temp_year = ass_temp_date %>% 
  group_by(year, station) %>% 
    summarize(
      temperature_mean = mean(temperature),
      temperature_n = length(temperature),
      temperature_sd = sd(temperature),
      temperature_se = temperature_sd /sqrt(temperature_n)) 

#ass_temp_date$time = ymd(ass_temp_date$time)  
```

##  Plots

```{r pressure, echo=FALSE}

ass_temp_plot = ggplot(ass_temp_date, aes(x=year_month, y=temperature_mean, color=station, group=station))+
  geom_line(aes(group=station), lwd = 1)+
  geom_point()+
  geom_errorbar(aes(ymax=temperature_mean+temperature_se,ymin=temperature_mean-temperature_se),width=0.1)+
  labs(title= "", x="Year", y="Mean Temperature (± SE)")+
  #scale_color_manual(values =  c("blue","red"),breaks = c("1", "0"), labels=c("Protected","Not Protected"))+
  #scale_x_continuous(limits = c(2005, 2018), breaks = c(1999,2000,2001,2002, 2003,2004,2005, 2006, 2007,2008, 2009,2010,2011, 2012,2013, 2014,2015, 2016), labels=c("","2000","","2002","","2004","","2006","","2008","","2010","","2012","","2014","","2016"))+
  theme_bw()+
  theme(
    legend.position="none",
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    title=element_text(size=12))

ass_temp_plot_year = ggplot(ass_temp_year, aes(x=year, y=temperature_mean, color=station, group=station))+
  geom_line(aes(group=station), lwd = 1)+
  geom_point()+
  geom_errorbar(aes(ymax=temperature_mean+temperature_se,ymin=temperature_mean-temperature_se),width=0.1)+
  labs(title= "", x="Year", y="Mean Temperature (± SE)")+
  #scale_color_manual(values =  c("blue","red"),breaks = c("1", "0"), labels=c("Protected","Not Protected"))+
  #scale_x_continuous(limits = c(2005, 2018), breaks = c(1999,2000,2001,2002, 2003,2004,2005, 2006, 2007,2008, 2009,2010,2011, 2012,2013, 2014,2015, 2016), labels=c("","2000","","2002","","2004","","2006","","2008","","2010","","2012","","2014","","2016"))+
  theme_bw()+
  theme(
    legend.position="none",
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    title=element_text(size=12))

```
