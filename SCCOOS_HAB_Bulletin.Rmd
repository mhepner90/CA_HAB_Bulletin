---
title: "SCCOOS HAB Bulletin Data and Plots"
author: "Megan Hepner"
date: "7/20/2018"
output: html_document
---

```{r Setup}
knitr::opts_chunk$set(echo = TRUE)

#rm(list=ls()) 
getwd()
#setwd("/Volumes/GoogleDrive/My Drive/SCCOOS")
library(cowplot) #get_legend 
library(dygraphs) #dygraphs 
library(ggplot2) #ggplot
library(tidyverse)
library(vegan) #spec, diversity
library(htmlwidgets)
library(xts)
library(lubridate) 
library(zoo) #as.yearmon
library(shiny)
library(grid) #unit.pmax
library(gridExtra)#grid.arrange 
library(gtable) #ggplotGrob #rbind 

#Conflicts: 
#dplyr::filter()   masks stats::filter()
#cowplot::ggsave() masks ggplot2::ggsave()
#dplyr::lag()      masks stats::lag()

select = dplyr::select #override MASS::select 
group_by =  dplyr::group_by #override plotly::group_by
summarise = dplyr::summarise #override plotly::summarise
filter = dplyr::filter
```

## SCCOOS Automated Shore Station Data (SASS)

```{r SASS data}

sass_temp = read_csv("2018_07_20_automated_shore_stations.csv") #A tibble: 86,384 x 3

#Parsed with column specification:
#cols(station = col_character(),time = col_datetime(format = ""),temperature = col_double())

sass_temp_date = sass_temp %>%  
  na.omit() %>% 
  mutate(date = as.Date(time, format ="%m/%d/%Y/%HH/%mm/%ss"), "%Y-%m") %>%
  mutate(year = format(as.Date(time, format="%m/%d/%Y/%HH/%mm/%ss"), "%Y")) %>% 
  mutate(month = format(as.Date(time, format="%m/%d/%Y/%HH/%mm/%ss"), "%m")) %>% 
  mutate(year = as.integer(year)) %>%
  mutate(month = as.integer(month)) %>%
  mutate(year_month = make_datetime(year, month)) 
  
sass_temp_year_month = sass_temp_date %>%
  group_by(year_month, station) %>% 
    summarize(
      temperature_mean = mean(temperature),
      temperature_n = length(temperature),
      temperature_sd = sd(temperature),
      temperature_se = temperature_sd /sqrt(temperature_n)) 
  
sass_temp_year = sass_temp_date %>% 
  group_by(year, station) %>% 
    summarize(
      temperature_mean = mean(temperature),
      temperature_n = length(temperature),
      temperature_sd = sd(temperature),
      temperature_se = temperature_sd /sqrt(temperature_n)) 

#sass_temp_date$time = ymd(sass_temp_date$time)  
```

```{r SASS Plots}

sass_temp_plot = ggplot(ass_temp_date, aes(x=year_month, y=temperature_mean, color=station, group=station))+
  geom_line(aes(group=station), lwd = 1)+
  geom_point()+
  geom_errorbar(aes(ymax=temperature_mean+temperature_se,ymin=temperature_mean-temperature_se),width=0.1)+
  labs(title= "", x="Year", y="Mean Temperature (± SE)")+
  #scale_color_manual(values =  c("blue","red"),breaks = c("1", "0"), labels=c("Protected","Not Protected"))+
  #scale_x_continuous(limits = c(2005, 2018), breaks = c(1999,2000,2001,2002, 2003,2004,2005, 2006, 2007,2009, 2009,2010,2011, 2012,2013, 2014,2015, 2016), labels=c("","2000","","2002","","2004","","2006","","2009","","2010","","2012","","2014","","2016"))+
  theme_bw()+
  theme(
    legend.position="none",
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    title=element_text(size=12))

sass_temp_plot_year = ggplot(ass_temp_year, aes(x=year, y=temperature_mean, color=station, group=station))+
  geom_line(aes(group=station), lwd = 1)+
  geom_point()+
  geom_errorbar(aes(ymax=temperature_mean+temperature_se,ymin=temperature_mean-temperature_se),width=0.1)+
  labs(title= "", x="Year", y="Mean Temperature (± SE)")+
  #scale_color_manual(values =  c("blue","red"),breaks = c("1", "0"), labels=c("Protected","Not Protected"))+
  #scale_x_continuous(limits = c(2005, 2018), breaks = c(1999,2000,2001,2002, 2003,2004,2005, 2006, 2007,2009, 2009,2010,2011, 2012,2013, 2014,2015, 2016), labels=c("","2000","","2002","","2004","","2006","","2009","","2010","","2012","","2014","","2016"))+
  theme_bw()+
  theme(
    legend.position="none",
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    title=element_text(size=12))

```

## California Department of Public Health (CDPH) Data

California Department of Public Health weekly observations for *Pseudo-nitzschia spp* and *Alexandrium spp.* 

Density Codes:
R = Rare (1)
P = Present (2)
C = Common (3)
A = Abundant (4)

The RAI is based on the sampling effort (total tow length), percent composition, and settled cell mass (in milliliters).

```{r June 2018 CDPH data}

CDPH_2018_06 = list.files(path="CDPH_Data/Pseudo_nitzschia/2018_06", pattern = "*.csv")
#"2018_06_week_1_Pn.csv" "2018_06_week_2_Pn.csv" "2018_06_week_3_Pn.csv" "2018_06_week_4_Pn.csv"

Pn_2018_06_wk1 = read_csv("CDPH_Data/Pseudo_nitzschia/2018_06/2018_06_week_1_Pn.csv") #19x12 
Pn_2018_06_wk2 = read_csv("CDPH_Data/Pseudo_nitzschia/2018_06/2018_06_week_2_Pn.csv") #21x11
Pn_2018_06_wk3 = read_csv("CDPH_Data/Pseudo_nitzschia/2018_06/2018_06_week_3_Pn.csv") #32x12
Pn_2018_06_wk4 = read_csv("CDPH_Data/Pseudo_nitzschia/2018_06/2018_06_week_4_Pn.csv") #24x11

CDPH_2018_06 = dplyr::bind_rows(Pn_2018_06_wk1, Pn_2018_06_wk2) #40x12
CDPH_2018_06 = dplyr::bind_rows(CDPH_2018_06, Pn_2018_06_wk3) #72x12
CDPH_2018_06 = dplyr::bind_rows(CDPH_2018_06, Pn_2018_06_wk4) #96x12

CDPH_Pn_2018_06 = CDPH_2018_06 %>%
  select(`Date -Sampled-`,`Sample Site`,`Percent Composition`,`Density -code-`,`RA Index`,Latitude,Longitude)

# Parsed with column specification:
#   `ID #` = col_character(),
#   `Date -Sampled-` = col_character(),
#   `NtoS -code-` = col_integer(),
#   `Sample Site` = col_character(),
#   `Species -code-` = col_character(),
#   `Percent Composition` = col_double(),
#   `Density -code-` = col_character(),
#   RA_Rank = col_integer(),
#   `RA Index` = col_double(),
#   Latitude = col_double(),
#   Longitude = col_double()
write_csv(CDPH_Pn_2018_06, "CDPH_Data/Pseudo_nitzschia/2018_06/CDPH_Pn_2018_06.csv")

CDPH_Pn_2018_06_max = CDPH_Pn_2018_06 %>%
  group_by(`Sample Site`, Latitude, Longitude) %>%
  summarize(
    percent_composition_max = max(`Percent Composition`))%>%
  #arrange(Sample_Site) %>%
  arrange(percent_composition_max)

write_csv(CDPH_Pn_2018_06_max, "CDPH_Data/Pseudo_nitzschia/2018_06/CDPH_Pn_2018_06_max.csv")

CDPH_2018_06 = list.files(path="CDPH_Data/Alexandria/2018_06", pattern = "*.csv")
#"2018_06_week_1_Al.csv" "2018_06_week_2_Al.csv" "2018_06_week_3_Al.csv" "2018_06_week_4_Al.csv"

Al_2018_06_wk1 = read_csv("CDPH_Data/Alexandria/2018_06/2018_06_week_1_Al.csv") 
Al_2018_06_wk2 = read_csv("CDPH_Data/Alexandria/2018_06/2018_06_week_2_Al.csv") 
Al_2018_06_wk3 = read_csv("CDPH_Data/Alexandria/2018_06/2018_06_week_3_Al.csv") 
Al_2018_06_wk4 = read_csv("CDPH_Data/Alexandria/2018_06/2018_06_week_4_Al.csv") 

CDPH_Al_2018_06 = dplyr::bind_rows(Al_2018_06_wk1, Al_2018_06_wk2) 
CDPH_Al_2018_06 = dplyr::bind_rows(CDPH_Al_2018_06, Al_2018_06_wk3) 
CDPH_Al_2018_06 = dplyr::bind_rows(CDPH_Al_2018_06, Al_2018_06_wk4)  

CDPH_Al_2018_06 = CDPH_Al_2018_06 %>%
  select(`Date -Sampled-`,`Sample Site`,`Percent Composition`,`Density -code-`,`RA Index`,Latitude,Longitude)

write_csv(CDPH_Al_2018_06, "CDPH_Data/Alexandria/2018_06/CDPH_Al_2018_06.csv") #62x7
#CDPH_Al_2018_06 = read_csv("CDPH_Data/Alexandria/CDPH_Al_2018_06.csv")


CDPH_Al_2018_06_max = CDPH_Al_2018_06 %>%
  group_by(`Sample Site`, Latitude, Longitude) %>%
  summarize(
    percent_composition_max = max(`Percent Composition`))%>%
  #arrange(Sample_Site) %>%
  arrange(percent_composition_max)

write_csv(CDPH_Al_2018_06_max, "CDPH_Data/Alexandria/2018_06/CDPH_Al_2018_06_max.csv") #36x7
```

```{r July 2018 CDPH data}

CDPH_2018 = list.files(path="CDPH_Data/Pseudo_nitzschia/", pattern = "*.csv")
#"2018_06_week_3_Pn.csv" "2018_06_week_4_Pn.csv" "2018_07_week_1_Pn.csv" "2018_07_week_2_Pn.csv" "2018_07_week_3_Pn.csv"

Pn_2018_07_wk1 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_07_week_1_Pn.csv") #36x11 
Pn_2018_07_wk2 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_07_week_2_Pn.csv") #38x11
Pn_2018_07_wk3 = read_csv("C/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_07_week_3_Pn.csv") #32x11
Pn_2018_07_wk4 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_07_week_4_Pn.csv") #32x11

CDPH_2018_07 = dplyr::bind_rows(Pn_2018_07_wk1, Pn_2018_07_wk2) #
CDPH_2018_07 = dplyr::bind_rows(CDPH_2018_07, Pn_2018_07_wk3) #
CDPH_2018_07 = dplyr::bind_rows(CDPH_2018_07, Pn_2018_07_wk4) #

CDPH_Pn_2018_07 = CDPH_2018_07 %>%
  select(`Date -Sampled-`,`Sample Site`,`Percent Composition`,`Density -code-`,`RA Index`,Latitude,Longitude)

write_csv(CDPH_Pn_2018_07, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/CDPH_Pn_2018_07.csv")

#CDPH_Pn_2018_07= read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/CDPH_Pn_2018_07.csv")

CDPH_Pn_2018_07_max = CDPH_Pn_2018_07 %>%
  group_by(Sample_Site,Latitude,Longitude) %>%
  summarize(
    percent_composition_max = max(Percent_Composition))%>%
  #arrange(Sample_Site) %>%
  arrange(percent_composition_max)

write_csv(CDPH_Pn_2018_07_max, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/CDPH_Pn_2018_07_max.csv")


CDPH_2018 = list.files(path="CDPH_Data/Alexandria/", pattern = "*.csv")
#"2018_06_week_3_Al.csv" "2018_06_week_4_Al.csv" "2018_07_week_1_Al.csv" "2018_07_week_2_Al.csv" "2018_07_week_3_Al.csv"

#Al_2018_06_wk4 = read_csv("CDPH_Data/Alexandria/2018_06_week_4_Al.csv")
Al_2018_07_wk1 = read_csv("CDPH_Data/Alexandria/2018_07_week_1_Al.csv") #26x11 
Al_2018_07_wk2 = read_csv("CDPH_Data/Alexandria/2018_07_week_2_Al.csv") #22x11
Al_2018_07_wk3 = read_csv("CDPH_Data/Alexandria/2018_07_week_3_Al.csv") #24x11
Al_2018_07_wk4 = read_csv("CDPH_Data/Alexandria/2018_07_week_4_Al.csv") #18x11

CDPH_Al_2018_07 = dplyr::bind_rows(Al_2018_07_wk1, Al_2018_07_wk2) #48x11 
CDPH_Al_2018_07 = dplyr::bind_rows(CDPH_Al_2018_07, Al_2018_07_wk3) #72x11
CDPH_Al_2018_07 = dplyr::bind_rows(CDPH_Al_2018_07, Al_2018_07_wk4) #90x11 

CDPH_Al_2018_07 = CDPH_Al_2018_07 %>%
  select(`Date -Sampled-`,`Sample Site`,`Percent Composition`,`Density -code-`,`RA Index`,Latitude,Longitude)

write_csv(CDPH_Al_2018_07, "CDPH_Data/Alexandria/CDPH_Al_2018_07.csv")
CDPH_Al_2018_07 = read_csv("CDPH_Data/Alexandria/CDPH_Al_2018_07.csv")

CDPH_Al_2018_07_max = CDPH_Al_2018_07 %>%
  group_by(Sample_Site,Latitude,Longitude) %>%
  summarize(
    percent_composition_max = max(Percent_Composition))%>%
  #arrange(Sample_Site) %>%
  arrange(percent_composition_max) #56x4 

write_csv(CDPH_Al_2018_07_max, "CDPH_Data/Alexandria/CDPH_Al_2018_07_max.csv")

```

```{r August 2018 CDPH data}

Pn_2018_09_wk1 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_09/2018_09_week_1_Pn.csv") #29x11 
Pn_2018_09_wk2 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_09/2018_09_week_2_Pn.csv") #24x11
Pn_2018_09_wk3 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_09/2018_09_week_3_Pn.csv") #31x11
Pn_2018_09_wk4 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_09/2018_09_week_4_Pn.csv") #39x11

CDPH_2018_09 = dplyr::bind_rows(Pn_2018_09_wk1, Pn_2018_09_wk2) #
CDPH_2018_09 = dplyr::bind_rows(CDPH_2018_09, Pn_2018_09_wk3) #
CDPH_2018_09 = dplyr::bind_rows(CDPH_2018_09, Pn_2018_09_wk4) #

CDPH_Pn_2018_09 = CDPH_2018_09 %>% #123x7
  select(`Date -Sampled-`,`Sample Site`,`Percent Composition`,`Density -code-`,`RA Index`,Latitude,Longitude)

write_csv(CDPH_Pn_2018_09, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_09/CDPH_Pn_2018_09.csv")

CDPH_Pn_2018_09_max = CDPH_Pn_2018_09 %>% 
  group_by(`Sample Site`,Latitude,Longitude) %>%
  summarize(
    percent_composition_max = max(`Percent Composition`))%>%
  #arrange(Sample_Site) %>%
  arrange(percent_composition_max) #66x4 

write_csv(CDPH_Pn_2018_09_max, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_09/CDPH_Pn_2018_09_max.csv")

Al_2018_09_wk1 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_09/2018_09_week_1_Al.csv") #16x11 
Al_2018_09_wk2 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_09/2018_09_week_2_Al.csv") #16x11 
Al_2018_09_wk3 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_09/2018_09_week_3_Al.csv") #12x11 
Al_2018_09_wk4 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_09/2018_09_week_4_Al.csv") #17x11 

CDPH_2018_09 = dplyr::bind_rows(Al_2018_09_wk1, Al_2018_09_wk2) #
CDPH_2018_09 = dplyr::bind_rows(CDPH_2018_09, Al_2018_09_wk3) #44x11
CDPH_2018_09 = dplyr::bind_rows(CDPH_2018_09, Al_2018_09_wk4) #61x11

CDPH_Al_2018_09 = CDPH_2018_09 %>%
  select(`Date -Sampled-`,`Sample Site`,`Percent Composition`,`Density -code-`,`RA Index`,Latitude,Longitude)

write_csv(CDPH_Al_2018_09, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_09/CDPH_Al_2018_09.csv")

CDPH_Al_2018_09_max = CDPH_Al_2018_09 %>% #32x7
  group_by(`Sample Site`,Latitude,Longitude) %>%
  summarize(
    percent_composition_max = max(`Percent Composition`))%>%
  #arrange(Sample_Site) %>%
  arrange(percent_composition_max) #26x4 

write_csv(CDPH_Al_2018_09_max, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_09/CDPH_Al_2018_09_max.csv")

```

```{r September 2018 CDPH data}

Pn_2018_09_wk1 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_09/2018_09_week_1_Pn.csv") #29x11 
Pn_2018_09_wk2 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_09/2018_09_week_2_Pn.csv") #24x11
Pn_2018_09_wk3 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_09/2018_09_week_3_Pn.csv") #31x11
Pn_2018_09_wk4 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_09/2018_09_week_4_Pn.csv") #39x11

CDPH_2018_09 = dplyr::bind_rows(Pn_2018_09_wk1, Pn_2018_09_wk2) #57
CDPH_2018_09 = dplyr::bind_rows(CDPH_2018_09, Pn_2018_09_wk3) #80
CDPH_2018_09 = dplyr::bind_rows(CDPH_2018_09, Pn_2018_09_wk4) #

CDPH_Pn_2018_09 = CDPH_2018_09 %>% #123x7
  select(`Date -Sampled-`,`Sample Site`,`Percent Composition`,`Density -code-`,`RA Index`,Latitude,Longitude)

write_csv(CDPH_Pn_2018_09, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_09/CDPH_Pn_2018_09.csv")

CDPH_Pn_2018_09_max = CDPH_Pn_2018_09 %>%  
  group_by(`Sample Site`,Latitude,Longitude) %>%
  summarize(
    percent_composition_max = max(`Percent Composition`))%>%
  #arrange(Sample_Site) %>%
  arrange(percent_composition_max) #66x4 

write_csv(CDPH_Pn_2018_09_max, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_09/CDPH_Pn_2018_09_max.csv")

Al_2018_09_wk1 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_09/2018_09_week_1_Al.csv") #16x11 
Al_2018_09_wk2 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_09/2018_09_week_2_Al.csv") #16x11 
Al_2018_09_wk3 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_09/2018_09_week_3_Al.csv") #12x11 
Al_2018_09_wk4 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_09/2018_09_week_4_Al.csv") #17x11 

CDPH_2018_09 = dplyr::bind_rows(Al_2018_09_wk1, Al_2018_09_wk2) #
CDPH_2018_09 = dplyr::bind_rows(CDPH_2018_09, Al_2018_09_wk3) #44x11
CDPH_2018_09 = dplyr::bind_rows(CDPH_2018_09, Al_2018_09_wk4) #61x11

CDPH_Al_2018_09 = CDPH_2018_09 %>%
  select(`Date -Sampled-`,`Sample Site`,`Percent Composition`,`Density -code-`,`RA Index`,Latitude,Longitude)

write_csv(CDPH_Al_2018_09, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_09/CDPH_Al_2018_09.csv")

CDPH_Al_2018_09_max = CDPH_Al_2018_09 %>% #32x7
  group_by(`Sample Site`,Latitude,Longitude) %>%
  summarize(
    percent_composition_max = max(`Percent Composition`))%>%
  #arrange(Sample_Site) %>%
  arrange(percent_composition_max) #26x4 

write_csv(CDPH_Al_2018_09_max, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_09/CDPH_Al_2018_09_max.csv")
```

```{r October 2018 CDPH data}

Pn_2018_10_wk1 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_10/2018_10_week_1_Pn.csv") #23x11 
Pn_2018_10_wk2 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_10/2018_10_week_2_Pn.csv") #29x11
Pn_2018_10_wk3 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_10/2018_10_week_3_Pn.csv") #14x11
Pn_2018_10_wk4 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_10/2018_10_week_4_Pn.csv") #6x11

CDPH_2018_10 = dplyr::bind_rows(Pn_2018_10_wk1, Pn_2018_10_wk2) 
CDPH_2018_10 = dplyr::bind_rows(CDPH_2018_10, Pn_2018_10_wk3) 
CDPH_2018_10 = dplyr::bind_rows(CDPH_2018_10, Pn_2018_10_wk4) #72x11

CDPH_Pn_2018_10 = CDPH_2018_10 %>% #
  select(`Date -Sampled-`,`Sample Site`,`Percent Composition`,`Density -code-`,`RA Index`,Latitude,Longitude)

write_csv(CDPH_Pn_2018_10, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_10/CDPH_Pn_2018_10.csv")

CDPH_Pn_2018_10_max = CDPH_Pn_2018_10 %>%  
  group_by(`Sample Site`,Latitude,Longitude) %>%
  summarize(
    percent_composition_max = max(`Percent Composition`))%>%
  #arrange(Sample_Site) %>%
  arrange(percent_composition_max) #72x7

write_csv(CDPH_Pn_2018_10_max, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_10/CDPH_Pn_2018_10_max.csv")

Al_2018_10_wk1 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_10/2018_10_week_1_Al.csv")  
Al_2018_10_wk2 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_10/2018_10_week_2_Al.csv")  
Al_2018_10_wk3 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_10/2018_10_week_3_Al.csv")  
Al_2018_10_wk4 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_10/2018_10_week_4_Al.csv")  

CDPH_2018_10 = dplyr::bind_rows(Al_2018_10_wk1, Al_2018_10_wk2) 
CDPH_2018_10 = dplyr::bind_rows(CDPH_2018_10, Al_2018_10_wk3) 
CDPH_2018_10 = dplyr::bind_rows(CDPH_2018_10, Al_2018_10_wk4) #30x11

CDPH_Al_2018_10 = CDPH_2018_10 %>%
  select(`Date -Sampled-`,`Sample Site`,`Percent Composition`,`Density -code-`,`RA Index`,Latitude,Longitude)

write_csv(CDPH_Al_2018_10, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_10/CDPH_Al_2018_10.csv")

CDPH_Al_2018_10_max = CDPH_Al_2018_10 %>% 
  group_by(`Sample Site`,Latitude,Longitude) %>%
  summarize(
    percent_composition_max = max(`Percent Composition`))%>%
  #arrange(Sample_Site) %>%
  arrange(percent_composition_max) #24x4

write_csv(CDPH_Al_2018_10_max, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_10/CDPH_Al_2018_10_max.csv")

```

```{r November 2018 CDPH data}

Pn_2018_11_wk1 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_11/2018_11_week_1_Pn.csv") #23x11 
Pn_2018_11_wk2 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_11/2018_11_week_2_Pn.csv") #29x11
Pn_2018_11_wk3 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_11/2018_11_week_3_Pn.csv") #14x11
Pn_2018_11_wk4 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_11/2018_11_week_4_Pn.csv") #6x11

CDPH_2018_11 = dplyr::bind_rows(Pn_2018_11_wk1, Pn_2018_11_wk2) #60x11
CDPH_2018_11 = dplyr::bind_rows(CDPH_2018_11, Pn_2018_11_wk3) #72x11
CDPH_2018_11 = dplyr::bind_rows(CDPH_2018_11, Pn_2018_11_wk4) #89x11

CDPH_Pn_2018_11 = CDPH_2018_11 %>% #
  select(`Date -Sampled-`,`Sample Site`,`Percent Composition`,`Density -code-`,`RA Index`,Latitude,Longitude)

write_csv(CDPH_Pn_2018_11, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_11/CDPH_Pn_2018_11.csv")

CDPH_Pn_2018_11_max = CDPH_Pn_2018_11 %>%  
  group_by(`Sample Site`,Latitude,Longitude) %>%
  summarize(
    percent_composition_max = max(`Percent Composition`))%>%
  #arrange(Sample_Site) %>%
  arrange(percent_composition_max) 

write_csv(CDPH_Pn_2018_11_max, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Pseudo_nitzschia/2018_11/CDPH_Pn_2018_11_max.csv")

Al_2018_11_wk1 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_11/2018_11_week_1_Al.csv")  
Al_2018_11_wk2 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_11/2018_11_week_2_Al.csv")  
Al_2018_11_wk3 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_11/2018_11_week_3_Al.csv")  
Al_2018_11_wk4 = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_11/2018_11_week_4_Al.csv")  

CDPH_2018_11 = dplyr::bind_rows(Al_2018_11_wk1, Al_2018_11_wk2) #23x11
CDPH_2018_11 = dplyr::bind_rows(CDPH_2018_11, Al_2018_11_wk3) #29x11
CDPH_2018_11 = dplyr::bind_rows(CDPH_2018_11, Al_2018_11_wk4) #38x11

CDPH_Al_2018_11 = CDPH_2018_11 %>%
  select(`Date -Sampled-`,`Sample Site`,`Percent Composition`,`Density -code-`,`RA Index`,Latitude,Longitude)

write_csv(CDPH_Al_2018_11, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_11/CDPH_Al_2018_11.csv")

CDPH_Al_2018_11_max = CDPH_Al_2018_11 %>% 
  group_by(`Sample Site`,Latitude,Longitude) %>%
  summarize(
    percent_composition_max = max(`Percent Composition`))%>%
  #arrange(Sample_Site) %>%
  arrange(percent_composition_max) #24x4

write_csv(CDPH_Al_2018_11_max, "/Volumes/GoogleDrive/My Drive/SCCOOS/CDPH/CDPH_Data/Alexandria/2018_11/CDPH_Al_2018_11_max.csv")

```
## The Marine Mammal Center Data 
```{r TMMC data and plots - 2018}

# TMMC_2018_08 = read.csv("TMMC_Data/TMMC_2018_08_15.csv")
# 
# TMMC_2018_monthly_count = TMMC_2018_09 %>%
#   select(Animal_Name,Common_Name,Age_Class,Sex,Occurrence,Strand_Date,Strand_Date_Month,County,City, Admit_Date,  Status, Disposition_Date) %>%
#   group_by(Strand_Date_Month)%>%
#   summarize(
#     Monthly_Count = sum(Occurrence))

#write_csv(TMMC_2018_monthly_count, "/Volumes/GoogleDrive/My Drive/SCCOOS/TMMC/TMMC_Data/TMMC_monthly_count.csv")

TMMC_2018_monthly_count = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/TMMC/TMMC_Data/TMMC_monthly_count.csv")

TMMC_Monthly_Plot = ggplot(TMMC_2018_monthly_count, aes(x=Strand_Date_Month, y=Monthly_Count))+
  geom_line(aes(y=Monthly_Count),color ="blue", lwd = 2)+
  geom_point(size=3, color="blue")+
  labs(title= "The Marine Mammal Center California Sea Lion Strandings", x="2018", y="Number of Strandings")+ #\n
  #scale_color_manual(values =  c("blue","red"),breaks = c("1", "0"), labels=c("Protected","Not Protected"))+
  scale_x_continuous(
    limits = c(1, 10), 
    breaks = c(1,2,3,4,5,6,7,8,9,10), 
    labels=c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct"))+
   scale_y_continuous(
    limits = c(0, 30), 
    breaks = c(0,5,10,15,20,25,30), 
    labels=c("0","5","10","15","20","25","30"))+
  theme_bw()+
  theme(
    legend.position="none",
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=16),
    axis.title.y=element_text(size=16),
    axis.text.x = element_text(size=16),
    axis.text.y = element_text(size=16),
    title=element_text(size=18),
    plot.title=element_text(hjust=0.5))

ggsave(file="TMMC_Monthly_Counts_2018_10.pdf", width=10, height =6 , path="/Volumes/GoogleDrive/My Drive/SCCOOS/TMMC/Plots")

```

```{r Marine Mammal Strandings 1990 - Present}

marine_mammal = read_csv('TMMC_Data/TMMC_data.csv')

marine_mammal_test = marine_mammal %>%
  select(Age_Class, Sex, Common_Name, Strand_Date, Stranding_City, Stranding_County,Stranding_Locality,Latitude, Longitude, Disposition) %>%
  mutate(Strand_Date = as.Date(Strand_Date, format ="%m/%d/%Y")) %>%
  mutate(Year = format(as.Date(Strand_Date, format="%m/%d/%Y"), "%Y")) %>% 
  mutate(Year_Month = format(as.Date(Strand_Date), "%Y-%m")) %>% 
  group_by(Year_Month) %>% #Age_Class, 
  summarize(Counts = length(Year_Month))

marine_mammal_test_date = marine_mammal %>%
  select(Age_Class, Sex, Common_Name, Strand_Date, Stranding_City, Stranding_County,Stranding_Locality,Latitude, Longitude, Disposition) %>%
  na.omit() %>%
  mutate(Strand_Date = as.Date(Strand_Date, format ="%m/%d/%Y")) %>%
  mutate(Year = format(as.Date(Strand_Date, format="%m/%d/%Y"), "%Y")) %>% 
  mutate(Year_Month = format(as.Date(Strand_Date), "%Y-%m")) %>% 
  group_by(Strand_Date, Age_Class) %>% #Age_Class, 
  summarize(Counts = length(Strand_Date))

marine_mammal_year = marine_mammal %>%
  select(Age_Class, Sex, Common_Name, Strand_Date, Stranding_City, Stranding_County,Stranding_Locality,Latitude, Longitude, Disposition) %>%
  na.omit() %>%
  mutate(Strand_Date = as.Date(Strand_Date, format ="%m/%d/%Y")) %>%
  mutate(Year = format(as.Date(Strand_Date, format="%m/%d/%Y"), "%Y")) %>% 
  mutate(Year_Month = format(as.Date(Strand_Date), "%Y-%m")) %>% 
  group_by(Year) %>% #Age_Class, 
  summarize(Counts = length(Year))

marine_mammal_year_ageclass = marine_mammal %>%
  select(Age_Class, Sex, Common_Name, Strand_Date, Stranding_City, Stranding_County,Stranding_Locality,Latitude, Longitude, Disposition) %>%
  na.omit() %>%
  mutate(Strand_Date = as.Date(Strand_Date, format ="%m/%d/%Y")) %>%
  mutate(Year = format(as.Date(Strand_Date, format="%m/%d/%Y"), "%Y")) %>% 
  mutate(Year_Month = format(as.Date(Strand_Date), "%Y-%m")) %>% 
  group_by(Year, Age_Class) %>% #, 
  summarize(Counts = length(Year))

```
## The Marine Mammal Center (TMMC) Stranding Plots 1990 - Present
```{r TMMC plots 1990 - 2018}

mms_year_month = ggplot(marine_mammal_test, aes(Year_Month, y=Counts)) +
  geom_point(size=2.5) +
  geom_line() +
  labs(x="Time", y= "Sea Lion Strandings")

mms_year = ggplot(marine_mammal_year_ageclass, aes(x=Year, y=Counts, color=Age_Class)) +
  geom_point(size=2.5) +
  geom_line(aes(group=Age_Class), lwd=1.5) +
  labs(x="Year", y= "Sea Lion Strandings") 

mms_year = ggplot(marine_mammal_year, aes(x=as.numeric(Year))) +
  geom_line(aes(y=Counts))+
  labs(x="Year", y= "Sea Lion Strandings")+
  scale_x_continuous(limits = c(1990, 2018), breaks = c(1990, 1992, 1994, 1996, 1998,2000,2002,2004,2006,2009,2010,2012,2014,2016,2018)) 

```

```{r TMMC dygraph}

marine_mammal = read_csv('TMMC_data.csv')

# dygraph_test = marine_mammal %>%
#   select(Age_Class, Sex, Common_Name, Strand_Date, Stranding_City, Stranding_County,Stranding_Locality,Latitude, Longitude, Disposition) %>%
#   na.omit() %>%
#   mutate(Strand_Date = as.Date(Strand_Date, format ="%Y/%d/%m")) %>%
#   mutate(Year_Month = format(as.Date(Strand_Date), "%Y-%m")) %>% 
#   group_by(Year_Month) %>% 
#   summarize(Counts = length(Year_Month))

dygraph_test = marine_mammal %>%
  select(Age_Class, Sex, Common_Name, Strand_Date, Stranding_City, Stranding_County,Stranding_Locality,Latitude, Longitude, Disposition) %>%
  na.omit() %>%
  mutate(Strand_Date = as.Date(Strand_Date, format ="%m/%d/%Y")) %>%
  mutate(Year = format(as.Date(Strand_Date, format="%m/%d/%Y"), "%Y")) %>% 
  mutate(Year_Month = format(as.Date(Strand_Date), "%Y-%m")) %>% 
  group_by(Year_Month) %>% #Age_Class, 
  summarize(Counts = length(Year_Month))

dygraph_test$Year_Month = as.yearmon(dygraph_test$Year_Month, "%Y-%m")
don2 = xts(x=dygraph_test$Counts, order.by = dygraph_test$Year_Month)

#dygraph_test$Strand_Date = ymd(dygraph_test$Strand_Date) 
#don = xts(x=dygraph_test$Counts, order.by = dygraph_test$Strand_Date)

dygraph(don2, main = "Sea Lion Strandings", xlab = "", ylab= "Sea Lion Strandings") %>%
  dyOptions(labelsUTC = TRUE, fillGraph=TRUE, fillAlpha=0.4, drawGrid = T, drawPoints = T) %>% #colors="#D8AE5A"
  dyRangeSelector() %>%
  dyAxis("x", valueRange = c(1990, 2018))
  #dyCrosshair(direction = "vertical") %>%
  #dyHighlight(highlightCircleSize = 5, highlightSeriesBackgroundAlpha = 0.2, hideOnMouseOut = FALSE)  %>%
  #dyRoller(rollPeriod = 1)

```

```{r TMMC Monthly Mean 1990 to Present}

#TMMC Stranding Data 1990 to present. Monthly mean 1990 to present with s/e 

# marine_mammal = read_csv('/Volumes/GoogleDrive/My Drive/SCCOOS/TMMC/TMMC_Data/TMMC_data_1990_2017.csv') 
# 
# TMMC_Monthly_Occurence = marine_mammal %>%
#   select(Strand_Date, Occurrence) %>%
#   mutate(Strand_Date = as.Date(Strand_Date, format ="%m/%d/%Y")) %>%
#   mutate(Year = format(as.Date(Strand_Date, format="%m/%d/%Y"), "%Y")) %>% 
#   mutate(Month = format(as.Date(Strand_Date, format="%m/%d/%Y"), "%m")) %>%
#   #mutate(Month_name = format(as.Date(Strand_Date, format="%m/%d/%Y"), "%B")) %>%
#   filter(!is.na(Month)) %>% 
#   group_by(Year, Month) %>%  #253x3
#   summarise(Occurence_YM = length(Occurrence)) #2321 observations from 1990 to 2017 

# TMMC_Monthly_Mean = TMMC_Monthly_Occurence %>% 
#   group_by(Month) %>%
#   summarise(
#     Monthly_mean = mean(Occurence_YM),
#     Monthly_n = length(Occurence_YM),
#     Monthly_sd = sd(Occurence_YM),
#     Monthly_se = Monthly_sd / sqrt(Monthly_n),
#     Monthly_min = min(Occurence_YM),
#     Monthly_max = max(Occurence_YM))

#write_csv(TMMC_Monthly_Mean, "TMMC_Data/TMMC_monthly_mean.csv")

#edit TMMC monthly mean '2018_counts' to refelct latest strandings 

TMMC_Monthly_Mean = read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/TMMC/TMMC_Data/TMMC_monthly_mean.csv")

TMMC_Monthly_Plot = ggplot(TMMC_Monthly_Mean, aes(x= Month, y=Monthly_mean))+
  geom_line(aes(y=Monthly_mean),color ="blue", lwd = 2)+
  geom_point(aes(y=Monthly_mean),size=3, color="blue")+
  geom_line(aes(y=`2018_counts`),color ="red", lwd = 2)+
  geom_point(aes(y=`2018_counts`),size=3, color="red")+
  geom_errorbar(aes(ymax=Monthly_mean+Monthly_se, ymin=Monthly_mean-Monthly_se), width=0.1)+
  labs(title= "The Marine Mammal Center California Sea Lion Strandings", x="", y="Number of Strandings (± SE)", color = "") + #\n
  scale_color_manual(labels=c("Mean Strandings","2018 Strandings"), values =  c("blue","red"))+
  scale_x_continuous(
    limits = c(1, 12), 
    breaks = c(1,2,3,4,5,6,7,8,9,10,11,12), 
    labels=c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"))+
   scale_y_continuous(
    limits = c(0, 30), 
    breaks = c(0,5,10,15,20,25,30), 
    labels=c("0","5","10","15","20","25","30"))+
  theme_bw()+
  theme(
    legend.position="bottom",
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=16),
    axis.title.y=element_text(size=16),
    axis.text.x = element_text(size=16),
    axis.text.y = element_text(size=16),
    title=element_text(size=18),
    plot.title=element_text(hjust=0.5))

ggsave(file="TMMC_Monthly_Average_2018_10.pdf", width=10, height =6 , path="/Volumes/GoogleDrive/My Drive/SCCOOS/TMMC/Plots")
```

# SCCOOS Manual Shore Station Nutrient and HAB Data 
Locations:
  "Santa Monica Pier"
  "Newport Pier"
  "Cal Poly Pier"
  "Stearns Wharf"
  "Santa Cruz Wharf"
  
  Parsed with column specification: cols(
    year = col_integer(),
    month = col_integer(),
    day = col_integer(),
    time = col_time(format = ""),
    latitude = col_double(),
    longitude = col_double(),
    depth_m = col_integer(),
    location = col_character(),
    `Chlorophyll_mg/m3` = col_double(),
    Nitrate_uM = col_double(),
    Phosphate_uM = col_double(),
    `Pseudo-nitzschia_delicatissima_group_cells/L` = col_double(),
    `Pseudo-nitzschia_seriata_group_cells/L` = col_double(),
    Silicate_uM = col_double(),
   `Domoic_Acid_ng/mL` = col_double()
  
```{r SCCOOS Manual Shore Stations Nutrient Data}

SCCOOS_Manual_Shore_Stations= read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CA_HAB_Bulletin/2018_10/HAB_Jan-Oct_2018_Hepner.csv")

SCCOOS_Nutrient_Data = SCCOOS_Manual_Shore_Stations %>%
  mutate(date = as.Date(paste(year, month, day, sep="-"))) %>% 
  mutate(date = format(as.Date(date, format ="%Y-%m-%d"),"%m-%d-%Y")) %>%
  #mutate(ymd = make_datetime(year,month,day))
  select(location, date,`Pseudo-nitzschia_delicatissima_group_cells/L`,`Pseudo-nitzschia_seriata_group_cells/L`,`Chlorophyll_mg/m3`,`Domoic_Acid_ng/mL`, Nitrate_uM, Phosphate_uM, Silicate_uM, latitude, longitude, year, month, day)

write_csv(HABMAP_Oct_2018, "/Volumes/GoogleDrive/My Drive/SCCOOS/CA_HAB_Bulletin/2018_10/HAB_Jan-Oct_2018.csv")

#Cal Poly Pier Plots - 1/1/18-8/28/18
Cal_Poly_Nutrient = SCCOOS_Nutrient_Data %>%
  filter(location == "Cal Poly Pier") %>% #39x14
  select(date, Nitrate_uM, Phosphate_uM, Silicate_uM, `Chlorophyll_mg/m3`) %>%
  gather(key= Nutrients, value = uM, Nitrate_uM, Phosphate_uM, Silicate_uM, `Chlorophyll_mg/m3`)

Cal_Poly_Nutrient_Plot = 
  ggplot(Cal_Poly_Nutrient, aes(x=date))+
  geom_point(aes(y=uM,color=Nutrients, group=Nutrients),size=3)+
  geom_line(aes(y=uM,color=Nutrients, group=Nutrients))+
  labs(title= "Cal Poly Pier", x="Date", y="", color = NULL) +
  scale_color_manual(labels=c("Chlorophyll (mg/m3)", "Nitrate (μM)", "Phosphate (μM)","Silicic Acid (μM)"),values=c("darkgreen","red","blue","purple"))+
  theme_bw()+
  theme(
    legend.position=c(0.9,0.85),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_text(angle = 90, hjust = 1),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))
ggsave(file="Cal_Poly_Nutrient_Plot.png", plot=Cal_Poly_Nutrient_Plot, width=10, height=6) #path="2018_10/plots"

#Newport Pier Plots - 1/1/18 - 10/29-18
Newport = SCCOOS_Nutrient_Data %>%
  filter(location == "Newport Pier")%>%  #44x14
  select(date, Nitrate_uM, Phosphate_uM, Silicate_uM, `Chlorophyll_mg/m3`) %>%
  gather(key= Nutrients, value = uM, Nitrate_uM, Phosphate_uM, Silicate_uM, `Chlorophyll_mg/m3`)
  #filter(Nitrate_uM != 'NaN')

Newport_Plot = 
  ggplot(Newport, aes(x=Newport$date)) +
  geom_point(aes(y=uM,color=Nutrients, group=Nutrients),size=3)+
  geom_line(aes(y=uM,color=Nutrients, group=Nutrients))+
  labs(title= "Newport Pier", x="Date", y="", color = NULL) +
  scale_color_manual(labels=c("Chlorophyll (mg/m3)", "Nitrate (μM)", "Phosphate (μM)","Silicic Acid (μM)"),values=c("darkgreen","red","blue","purple"))+
  theme_bw()+
  theme(
    legend.position=c(0.9,0.85),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_text(angle = 90, hjust = 1),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))
ggsave(file="Newport_Pier_Nutrient_Plot.png", plot=Newport_Plot, width=10, height=6) #path="2018_10/plots"

#Santa Cruz Municipal Wharf Plots - 1/1/18 - 8/28/18
Santa_Cruz_Nutrients = SCCOOS_Nutrient_Data %>%
  filter(location == "Santa Cruz Wharf")%>% #41x14
  select(date, Nitrate_uM, Phosphate_uM, Silicate_uM, `Chlorophyll_mg/m3`) %>%
  gather(key= Nutrients, value = uM, Nitrate_uM, Phosphate_uM, Silicate_uM, `Chlorophyll_mg/m3`)

Santa_Cruz_Nutrient_Plot = 
  ggplot(Cal_Poly_Nutrient, aes(x=date))+
  geom_point(aes(y=uM,color=Nutrients, group=Nutrients),size=3)+
  geom_line(aes(y=uM,color=Nutrients, group=Nutrients))+
  labs(title= "Santa Cruz Municipal Wharf", x="Date", y="", color = NULL) + #μm
  scale_color_manual(labels=c("Chlorophyll (mg/m3)", "Nitrate (μM)", "Phosphate (μM)","Silicic Acid (μM)"),values=c("darkgreen","red","blue","purple"))+
  theme_bw()+
  theme(
    legend.position=c(0.9,0.85),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_text(angle = 90, hjust = 1),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))
ggsave(file="Santa_Cruz_Nutrient_Plot.png", plot=Santa_Cruz_Nutrient_Plot, width=10, height=6) #path="2018_10/plots"

#Santa Monica Pier Plots - No Nutrient data. All NA's 
Santa_Monica = SCCOOS_Nutrient_Data %>%
  filter(location == "Santa Monica Pier") %>%
  select(date, Nitrate_uM, Phosphate_uM, Silicate_uM, `Chlorophyll_mg/m3`) %>%
  gather(key= Nutrients, value = uM, Nitrate_uM, Phosphate_uM, Silicate_uM, `Chlorophyll_mg/m3`)

Santa_Monica_Plot = 
  ggplot(Santa_Monica, aes(x=Santa_Monica$date)) +
  geom_point(aes(y=uM,color=Nutrients, group=Nutrients),size=3)+
  geom_line(aes(y=uM,color=Nutrients, group=Nutrients))+
  labs(title= "Santa Monica Pier", x="Date", y="", color = NULL) +
  scale_color_manual(labels=c("Chlorophyll (mg/m3)", "Nitrate (μM)", "Phosphate (μM)","Silicic Acid (μM)"),values=c("darkgreen","red","blue","purple"))+
  theme_bw()+
  theme(
    legend.position=c(0.9,0.85),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_text(angle = 90, hjust = 1),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))
ggsave(file="Santa_Monica_Nutrient_Plot.png", plot=Santa_Monica_Plot, width=10, height=6) #path="2018_10/plots"

#Stearns Wharf Plots - 1/1/18-8/28/18
Stearns_Wharf_Nutrient = SCCOOS_Nutrient_Data %>% #35x14
  filter(location == "Stearns Wharf")%>%
  select(date, Nitrate_uM, Phosphate_uM, Silicate_uM, `Chlorophyll_mg/m3`) %>%
  gather(key= Nutrients, value = uM, Nitrate_uM, Phosphate_uM, Silicate_uM, `Chlorophyll_mg/m3`)

Stearns_Wharf_Nutrient_Plot = 
  ggplot(Cal_Poly_Nutrient, aes(x=date))+
  geom_point(aes(y=uM,color=Nutrients, group=Nutrients),size=3)+
  geom_line(aes(y=uM,color=Nutrients, group=Nutrients))+
  labs(title= "Stearns Wharf", x="Date", y="", color = NULL) +
  scale_color_manual(labels=c("Chlorophyll (mg/m3)", "Nitrate (μM)", "Phosphate (μM)","Silicic Acid (μM)"),values=c("darkgreen","red","blue","purple"))+
  theme_bw()+
  theme(
    legend.position=c(0.9,0.85),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_text(angle = 90, hjust = 1),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))
ggsave(file="Sterns_Wharf_Nutrient_Plot.png", plot=Stearns_Wharf_Nutrient_Plot, width=10, height=6) #path="2018_10/plots"

```

```{r SCCOOS Manual Shore Stations HAB data}

SCCOOS_HAB_data= read_csv("/Volumes/GoogleDrive/My Drive/SCCOOS/CA_HAB_Bulletin/2018_10/HAB_Jan-Oct_2018_Hepner.csv")

SCCOOS_HAB_data = SCCOOS_HAB_data %>%
  mutate(date = as.Date(paste(year, month, day, sep="-"))) %>% 
  mutate(date = format(as.Date(date, format ="%Y-%m-%d"),"%m-%d-%Y")) %>%
  #mutate(ymd = make_datetime(year,month,day))
  select(location, date,`Pseudo-nitzschia_delicatissima_group_cells/L`,`Pseudo-nitzschia_seriata_group_cells/L`,`Domoic_Acid_ng/mL`, year, month, day)

#Cal Poly Pier
Cal_Poly_HAB = SCCOOS_HAB_data %>% #39x8
  filter(location == "Cal Poly Pier") %>%
  select(location,date,`Pseudo-nitzschia_delicatissima_group_cells/L`, `Pseudo-nitzschia_seriata_group_cells/L`,`Domoic_Acid_ng/mL`)

#max(Cal_Poly_HAB$`Pseudo-nitzschia_delicatissima_group_cells/L`) #25055
#max(Cal_Poly_HAB$`Pseudo-nitzschia_seriata_group_cells/L`) #13860
#max(Cal_Poly_HAB$`Domoic_Acid_ng/mL`) #NaN 

Cal_Poly_HAB_Plot = 
  ggplot(Cal_Poly_HAB, aes(x=date))+
  geom_point(aes(y=`Pseudo-nitzschia_delicatissima_group_cells/L`, color="Pseudo-nitzschia 'delicatissima' size class (cells/L)"),size=3)+
  geom_point(aes(y=`Pseudo-nitzschia_seriata_group_cells/L`,color="Pseudo-nitzschia 'seriata' size class (cells/L)"),size=3)+
  scale_y_continuous(
    limits=c(0,300000),
    breaks=c(0,25000,50000,75000,100000,125000,150000,175000,200000,225000,250000,275000,300000),
    labels=c("0","","50,000","","100,000","","150,000","","200,000","","250,000","","300,000"))+
  scale_color_manual(
    labels =c("Pseudo-nitzschia 'delicatissima' size class (cells/L)","Pseudo-nitzschia 'seriata' size class (cells/L)"), 
    values =c("hotpink","dodgerblue"))+
  labs(title= "New Port Pier", x="Date", y="cells/L", color = "")+
  theme_bw()+
  theme(
    plot.margin = unit(c(0, 0, 0, 0), "cm"),
    legend.position = c(0.75,0.8), #c(0.85,0.9)
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.margin = margin(0.25,0.25,0.25,0.25,unit="cm"),
    legend.text = element_text(size=12), #hjust = 0, vjust = 0
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_blank(),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))

Cal_Poly_DA_Plot = 
  ggplot(Cal_Poly_HAB, aes(x=date))+
  geom_point(aes(y=`Domoic_Acid_ng/mL`, color="Domic Acid (ng/mL)"),size=3)+
  labs(title= "", x="Date", y="ng/mL", color = "")+
  scale_y_continuous(limits=c(0,1))+
  scale_color_manual(
    labels =c("Domic Acid (ng/mL)"), 
    values =c("limegreen"))+
  theme_bw()+
  theme(
    plot.margin = unit(c(0, 0, 0, 0), "cm"), 
    legend.position = c(0.85,0.8),
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.margin = margin(0.25,0.25,0.25,0.25,unit="cm"),
    legend.text = element_text(size=12, vjust=0.5, hjust=0.5), #hjust = 0, vjust = 0
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_text(angle = 90, hjust = 1),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))

Cal_Poly_Combo_Plot = plot_grid(Cal_Poly_HAB_Plot,Cal_Poly_DA_Plot, align="v",nrow=2, rel_heights = c(1, 4/5))
save_plot("Cal_Poly_Combo_Plot.png",Cal_Poly_Combo_Plot, base_width = 10, base_height = 6)

#Newport Pier
Newport_HAB = SCCOOS_HAB_data %>% #44x8
  filter(location == "Newport Pier") %>%
  select(location,date,`Pseudo-nitzschia_delicatissima_group_cells/L`, `Pseudo-nitzschia_seriata_group_cells/L`,`Domoic_Acid_ng/mL`)

#max(Newport_HAB$`Pseudo-nitzschia_delicatissima_group_cells/L`) #335242
#max(Newport_HAB$`Pseudo-nitzschia_seriata_group_cells/L`) #259877
#max(Newport_HAB$`Domoic_Acid_ng/mL`) #0.14

Newport_HAB_Pot = 
  ggplot(Newport_HAB, aes(x=date))+
   geom_point(aes(y=`Pseudo-nitzschia_delicatissima_group_cells/L`, color="Pseudo-nitzschia 'delicatissima' size class (cells/L)"),size=3)+
  geom_point(aes(y=`Pseudo-nitzschia_seriata_group_cells/L`,color="Pseudo-nitzschia 'seriata' size class (cells/L)"),size=3)+
  scale_y_continuous(
    limits=c(0,300000),
    breaks=c(0,25000,50000,75000,100000,125000,150000,175000,200000,225000,250000,275000,300000),
    labels=c("0","","50,000","","100,000","","150,000","","200,000","","250,000","","300,000"))+
  scale_color_manual(
    labels =c("Pseudo-nitzschia 'delicatissima' size class (cells/L)","Pseudo-nitzschia 'seriata' size class (cells/L)"), 
    values =c("hotpink","dodgerblue"))+
  labs(title= "Newport Pier", x="", y="cells/L", color = "")+
  theme_bw()+
  theme(
    plot.margin = unit(c(0, 0, 0, 0), "cm"),
    legend.position = c(0.75,0.8), #c(0.85,0.9)
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.margin = margin(0.25,0.25,0.25,0.25,unit="cm"),
    legend.text = element_text(size=12), #hjust = 0, vjust = 0
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_blank(),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))

Newport_DA_Pot = 
  ggplot(Newport_HAB, aes(x=date))+
  geom_point(aes(y=`Domoic_Acid_ng/mL`, color="Domic Acid (ng/mL)"),size=3)+
  labs(title= "", x="Date", y="ng/mL", color = "")+
  scale_y_continuous(limits=c(0,1))+
  scale_color_manual(
    labels =c("Domic Acid (ng/mL)"), 
    values =c("limegreen"))+
  theme_bw()+
  theme(
    plot.margin = unit(c(0, 0, 0, 0), "cm"), #margin(t = 0, r = 0, b = 0, l = 0, unit = "pt")
    legend.position = c(0.85,0.8),
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.margin = margin(0.25,0.25,0.25,0.25,unit="cm"),
    legend.text = element_text(size=12, vjust=0.5, hjust=0.5), #hjust = 0, vjust = 0
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_text(angle = 90, hjust = 1),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))

Newport_Combo_Plot = plot_grid(Newport_HAB_Pot,Newport_DA_Pot, align="v",nrow=2, rel_heights = c(1, 4/5))
save_plot("Newport_Combo_Plot.png",Newport_Combo_Plot, base_width = 10, base_height = 6)

#Santa Cruz Municipal Wharf 
Santa_Cruz_HAB = SCCOOS_HAB_data %>% #41x8
  filter(location == "Santa Cruz Wharf") %>%
  select(location,date,`Pseudo-nitzschia_delicatissima_group_cells/L`, `Pseudo-nitzschia_seriata_group_cells/L`,`Domoic_Acid_ng/mL`)

#max(Santa_Cruz_HAB$`Pseudo-nitzschia_delicatissima_group_cells/L`) #NaN 
#max(Santa_Cruz_HAB$`Pseudo-nitzschia_seriata_group_cells/L`) #39600
#max(Santa_Cruz_HAB$`Domoic_Acid_ng/mL`) #0.83

Santa_Cruz_HAB_Plot = 
  ggplot(Santa_Cruz_HAB, aes(x=date))+
  geom_point(aes(y=`Pseudo-nitzschia_delicatissima_group_cells/L`, color="Pseudo-nitzschia 'delicatissima' size class (cells/L)"),size=3)+
  geom_point(aes(y=`Pseudo-nitzschia_seriata_group_cells/L`,color="Pseudo-nitzschia 'seriata' size class (cells/L)"),size=3)+
  scale_y_continuous(
    limits=c(0,300000),
    breaks=c(0,25000,50000,75000,100000,125000,150000,175000,200000,225000,250000,275000,300000),
    labels=c("0","","50,000","","100,000","","150,000","","200,000","","250,000","","300,000"))+
  scale_color_manual(
    labels =c("Pseudo-nitzschia 'delicatissima' size class (cells/L)","Pseudo-nitzschia 'seriata' size class (cells/L)"), 
    values =c("hotpink","dodgerblue"))+
  labs(title= "Santa Cruz Municipal Wharf", x="", y="cells/L", color = "")+
  theme_bw()+
  theme(
    plot.margin = unit(c(0, 0, 0, 0), "cm"),
    legend.position = c(0.75,0.8), #c(0.85,0.9)
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.margin = margin(0.25,0.25,0.25,0.25,unit="cm"),
    legend.text = element_text(size=12), #hjust = 0, vjust = 0
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_blank(),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))
  
Santa_Cruz_DA_Plot = 
  ggplot(Santa_Cruz_HAB, aes(x=date))+
    geom_point(aes(y=`Domoic_Acid_ng/mL`, color="Domic Acid (ng/mL)"),size=3)+
  labs(title= "", x="Date", y="ng/mL", color = "")+
  scale_y_continuous(limits=c(0,1))+
  scale_color_manual(
    labels =c("Domic Acid (ng/mL)"), 
    values =c("limegreen"))+
  theme_bw()+
  theme(
    plot.margin = unit(c(0, 0, 0, 0), "cm"), #margin(t = 0, r = 0, b = 0, l = 0, unit = "pt")
    legend.position = c(0.85,0.8),
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.margin = margin(0.25,0.25,0.25,0.25,unit="cm"),
    legend.text = element_text(size=12, vjust=0.5, hjust=0.5), #hjust = 0, vjust = 0
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_text(angle = 90, hjust = 1),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))
  
Santa_Cruz_Combo_Plot = plot_grid(Santa_Cruz_HAB_Plot,Santa_Cruz_DA_Plot, align="v",nrow=2, rel_heights = c(1, 4/5))
save_plot("Santa_Cruz_Combo_Plot.png",Santa_Cruz_Combo_Plot, base_width = 10, base_height = 6)
  
 #Santa Monica Pier 
Santa_Monica_HAB = SCCOOS_HAB_data %>%
  filter(location == "Santa Monica Pier")%>% #12x8
  select(location,date,`Pseudo-nitzschia_delicatissima_group_cells/L`, `Pseudo-nitzschia_seriata_group_cells/L`,`Domoic_Acid_ng/mL`)

#max(Santa_Monica_HAB$`Pseudo-nitzschia_delicatissima_group_cells/L`) #3740
#max(Santa_Monica_HAB$`Pseudo-nitzschia_seriata_group_cells/L`) #28050
#max(Santa_Monica_HAB$`Domoic_Acid_ng/mL`) #Nan
#length(Santa_Monica_HAB$`Pseudo-nitzschia_delicatissima_group_cells/L`) #12

Santa_Monica_HAB_Plot = 
  ggplot(Santa_Monica_HAB, aes(x=date))+
  geom_point(aes(y=`Pseudo-nitzschia_delicatissima_group_cells/L`, color="Pseudo-nitzschia 'delicatissima' size class (cells/L)"),size=3)+
  geom_point(aes(y=`Pseudo-nitzschia_seriata_group_cells/L`,color="Pseudo-nitzschia 'seriata' size class (cells/L)"),size=3)+
  scale_y_continuous(
    limits=c(0,300000),
    breaks=c(0,25000,50000,75000,100000,125000,150000,175000,200000,225000,250000,275000,300000),
    labels=c("0","","50,000","","100,000","","150,000","","200,000","","250,000","","300,000"))+
  scale_color_manual(
    labels =c("Pseudo-nitzschia 'delicatissima' size class (cells/L)","Pseudo-nitzschia 'seriata' size class (cells/L)"), 
    values =c("hotpink","dodgerblue"))+
  labs(title= "Santa Monica Pier", x="", y="cells/L", color = "")+
  theme_bw()+
  theme(
    plot.margin = unit(c(0, 0, 0, 0), "cm"),
    legend.position = c(0.75,0.8), #c(0.85,0.9)
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.margin = margin(0.25,0.25,0.25,0.25,unit="cm"),
    legend.text = element_text(size=12), #hjust = 0, vjust = 0
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_blank(),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))

Santa_Monica_DA_Plot = 
  ggplot(Santa_Monica_HAB, aes(x=date))+
  geom_point(aes(y=`Domoic_Acid_ng/mL`, color="Domic Acid (ng/mL)"),size=3)+
  labs(title= "", x="Date", y="ng/mL", color = "")+
  scale_y_continuous(limits=c(0,1))+
  scale_color_manual(
    labels =c("Domic Acid (ng/mL)"), 
    values =c("limegreen"))+
  theme_bw()+
  theme(
    plot.margin = unit(c(0, 0, 0, 0), "cm"), #margin(t = 0, r = 0, b = 0, l = 0, unit = "pt")
    legend.position = c(0.85,0.8),
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.margin = margin(0.25,0.25,0.25,0.25,unit="cm"),
    legend.text = element_text(size=12, vjust=0.5, hjust=0.5), #hjust = 0, vjust = 0
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_text(angle = 90, hjust = 1),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))

Santa_Monica_Combo_Plot = plot_grid(Santa_Monica_HAB_Plot,Santa_Monica_DA_Plot, align="v",nrow=2, rel_heights = c(1, 4/5))
save_plot("Santa_Monica_Combo_Plot.png",Santa_Monica_Combo_Plot, base_width = 10, base_height = 6)

#Stearns Wharf  
Stearns_Wharf_HAB = SCCOOS_HAB_data %>% #35x8
  filter(location == "Stearns Wharf") %>%
  select(location,date,`Pseudo-nitzschia_delicatissima_group_cells/L`, `Pseudo-nitzschia_seriata_group_cells/L`,`Domoic_Acid_ng/mL`)

#max(Stearns_Wharf_HAB$`Pseudo-nitzschia_delicatissima_group_cells/L`) #209692
#max(Stearns_Wharf_HAB$`Pseudo-nitzschia_seriata_group_cells/L`) #69897
#max(Stearns_Wharf_HAB$`Domoic_Acid_ng/mL`) #Nan
#length(Stearns_Wharf_HAB$`Pseudo-nitzschia_delicatissima_group_cells/L`) #35

Stearns_Wharf_HAB_Plot = 
  ggplot(Stearns_Wharf_HAB, aes(x=date))+
  geom_point(aes(y=`Pseudo-nitzschia_delicatissima_group_cells/L`, color="Pseudo-nitzschia 'delicatissima' size class (cells/L)"),size=3)+
  geom_point(aes(y=`Pseudo-nitzschia_seriata_group_cells/L`,color="Pseudo-nitzschia 'seriata' size class (cells/L)"),size=3)+
  scale_y_continuous(
    limits=c(0,300000),
    breaks=c(0,25000,50000,75000,100000,125000,150000,175000,200000,225000,250000,275000,300000),
    labels=c("0","","50,000","","100,000","","150,000","","200,000","","250,000","","300,000"))+
  scale_color_manual(
    labels =c("Pseudo-nitzschia 'delicatissima' size class (cells/L)","Pseudo-nitzschia 'seriata' size class (cells/L)"), 
    values =c("hotpink","dodgerblue"))+
  labs(title= "Stearns Wharf", x="", y="cells/L", color = "")+
  theme_bw()+
  theme(
    plot.margin = unit(c(0, 0, 0, 0), "cm"),
    legend.position = c(0.75,0.8), #c(0.85,0.9)
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.margin = margin(0.25,0.25,0.25,0.25,unit="cm"),
    legend.text = element_text(size=12), #hjust = 0, vjust = 0
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_blank(),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))

 Stearns_Wharf_DA_Plot = 
  ggplot(Stearns_Wharf_HAB, aes(x=date))+
  geom_point(aes(y=`Domoic_Acid_ng/mL`, color="Domic Acid (ng/mL)"),size=3)+
  labs(title= "", x="Date", y="ng/mL", color = "")+
  scale_y_continuous(limits=c(0,1))+
  scale_color_manual(
    labels =c("Domic Acid (ng/mL)"), 
    values =c("limegreen"))+
  theme_bw()+
  theme(
    plot.margin = unit(c(0, 0, 0, 0), "cm"), #margin(t = 0, r = 0, b = 0, l = 0, unit = "pt")
    legend.position = c(0.85,0.8),
    legend.background = element_rect(color = "black", size=0.2, linetype="solid"),
    legend.title = element_blank(),
    legend.justification = "center",
    legend.margin = margin(0.25,0.25,0.25,0.25,unit="cm"),
    legend.text = element_text(size=12, vjust=0.5, hjust=0.5), #hjust = 0, vjust = 0
    panel.grid.major=element_blank(),
    panel.grid.minor=element_blank(),
    axis.title.x=element_text(size=12),
    axis.title.y=element_text(size=12),
    axis.text.x = element_text(angle = 90, hjust = 1),
    plot.title = element_text(hjust=0.5),
    title=element_text(size=12))

Stearns_Wharf_Combo_Plot = plot_grid(Stearns_Wharf_HAB_Plot,Stearns_Wharf_DA_Plot, align="v",nrow=2, rel_heights = c(1, 4/5))
save_plot("stearns_wharf_combo_plot.png",Stearns_Wharf_Combo_Plot, base_width = 10, base_height = 6)

#stearns_wharf_combo = grid.arrange(Stearns_Wharf_HAB_Plot, Stearns_Wharf_DA_Plot, nrow=2, ncol=1)
#ggsave(file="test.png", width=10, height=6)
# g2 = ggplotGrob(Stearns_Wharf_HAB_Plot)
# g3 = ggplotGrob(Stearns_Wharf_DA_Plot)
# g = rbind(g2, g3, size="first")
# g$widths = unit.pmax(g2$widths, g3$widths)
# grid.newpage()
# grid.draw(g)
# png("stearns_wharf_combo_plot.png"); plot(g); dev.off()


```
